---
// /src/components/atoms/ScrollToTopArrow.astro
import { useDesign } from "../../utils/useDesign";

const {
  visibleOffset = 300,  // after what distance will it be displayed
  buttonClass,
  iconClass,
} = Astro.props;

// fallback design
const btnClass = buttonClass || useDesign("scrollToTop.button", "fixed bottom-6 right-6 bg-stone-800 text-white p-3 rounded-full shadow-lg transition-opacity duration-300 opacity-0 hover:bg-stone-700");
const icnClass = iconClass || useDesign("scrollToTop.icon", "w-5 h-5");
---
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const btn = document.querySelector(".scroll-to-top-btn");
    if (!btn) return;

    const toggleVisibility = () => {
      if (window.scrollY > Number(btn.dataset.offset || 300)) {
        btn.style.opacity = "1";
        btn.style.pointerEvents = "auto";
      } else {
        btn.style.opacity = "0";
        btn.style.pointerEvents = "none";
      }
    };

    window.addEventListener("scroll", toggleVisibility);

    btn.addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
    });
  });
</script>

<button
  class={`scroll-to-top-btn ${btnClass}`}
  data-offset={visibleOffset}
  aria-label="Scroll to top"
>
  <svg xmlns="http://www.w3.org/2000/svg" class={icnClass} fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
    <path stroke-linecap="round" stroke-linejoin="round" d="M5 15l7-7 7 7" />
  </svg>
</button>
